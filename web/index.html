<html>
<head>
	<title>UTAU Lyrics Wiki importer</title>
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
	<style>

	</style>
</head>

<body>
	
	<nav class="navbar navbar-default">
		<div class="container">
			<p data-bind="visible: !loggedIn()" class="navbar-text navbar-right">
				<a class="navbar-link" href="http://vocadb.net/User/Login">Log in to VocaDB</a>
			</p>
			<p data-bind="with: user" class="navbar-text navbar-right">
				Logged in to VocaDB as <span data-bind="text: name"></span>
			</p>
		</div>
	</nav>

	<div class="container" style="display: none;" data-bind="visible: true">
		<div class="row">
			<div class="col-sm-12">
				<h1>UTAU Lyrics Wiki importer</h1>
				
				<div class="alert alert-danger" data-bind="visible: !loggedIn()">
					You must be logged in to VocaDB to use this page. 
					<a href="http://vocadb.net/User/Login">Log in here.</a>
				</div>	
				
				<div class="alert alert-success" data-bind="visible: submittedSongId">
					<a data-bind="attr: { href: 'http://vocadb.net/S/' + submittedSongId() }">Submitted to VocaDB.</a>					
				</div>			

				<form class="form-horizontal" data-bind="visible: user">
					<div class="input-group">
						<input type="text" data-bind="textInput: url" class="form-control" id="url" placeholder="UTAU Lyrics Wiki URL">
						<span class="input-group-btn">
							<button type="submit" data-bind="click: loadUrl" class="btn btn-primary">Load</button>
						</span>
					</div>
					<hr />
				</form>
				
				<form data-bind="with: result, submit: submit">
					<div class="alert alert-info" data-bind="visible: $data.vocadb">
						<a data-bind="attr: { href: 'http://vocadb.net/S/' + $data.vocadb }">This song is already on VocaDB.</a>
					</div>
					
					<h3>Title</h3>
					<div>
						Original: <input type="text" data-bind="textInput: names.original" readonly /><br />
						Romanized: <input type="text" data-bind="textInput: names.romanized" readonly /><br />
						English: <input type="text" data-bind="textInput: names.english" readonly />
					</div>

					<h3>Media</h3>
					<ul data-bind="foreach: media">
						<li data-bind="visible: website === 'yt'"><a data-bind="text: 'YouTube', attr: { href: $root.getPvUrl($data) }"></a></li>
						<li data-bind="visible: website === 'nn'"><a data-bind="text: 'NicoNicoDouga', attr: { href: $root.getPvUrl($data) }"></a></li>
						<li data-bind="visible: website === 'pp'"><a data-bind="text: 'Piapro', attr: { href: $root.getPvUrl($data) }"></a></li>
					</ul>

					<!-- ko if: $data.producers -->
					<h3>Producers</h3>
					<div data-bind="template: { name: 'artists-template', data: producers }"></div>
					<!-- /ko -->

					<!-- ko if: $data.vocalists -->
					<h3>Vocalists</h3>
					<div data-bind="template: { name: 'artists-template', data: vocalists }"></div>
					<!-- /ko -->

					<!-- ko if: lyrics && (lyrics.ja || lyrics['ja-romanized']) -->
					<h3>Lyrics</h3>
					<ul>
						<li data-bind="visible: lyrics.ja">Original (Japanese)</li>
						<li data-bind="visible: lyrics['ja-romanized']">Romanized</li>
					</ul>
					<!-- /ko -->

					<p>
						<button data-bind="enable: !$parent.submitting()" class="btn btn-primary" type="submit">Submit to VocaDB</button>
					</p>
										
					<div class="alert alert-danger" data-bind="visible: $root.submitError">
						Failed to submit song:
						<span data-bind="text: $root.submitError"></span>
					</div>			

				</form>
			</div>
		</div>		
	</div>

	<script type="text/html" id="artists-template">
		<ul data-bind="foreach: $data">
			<li>
				<a data-bind="visible: $data.vocadb, text: name + ($data.roles ? ' (' + roles + ')': ''), attr: { href: 'http://vocadb.net/Ar/' + $data.vocadb }"></a>
				<span data-bind="visible: !$data.vocadb, text: name + ($data.roles ? ' (' + roles + ')': '')"></span>
			</li>
		</ul>
	</script>

	<script src="https://code.jquery.com/jquery-3.0.0.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.0/knockout-min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.13.1/lodash.min.js"></script>
	<script type="text/javascript" src="script.js"></script>
</body>
</html>